@import 'tailwindcss';

@config "../../tailwind.config.js";

/* Tailwind Preflight is now enabled - provides CSS reset
   Additional app-specific base styles below */
@layer base {
  /* Ensure form elements inherit app fonts */
  button,
  input,
  textarea,
  select {
    font: inherit;
  }

  /* Remove list styles */
  ol,
  ul {
    list-style: none;
  }

  /* Remove quotes */
  blockquote,
  q {
    quotes: none;
  }

  /* Anchor reset */
  a {
    color: inherit;
    text-decoration: inherit;
  }

  /* Prevent text size adjustment on orientation change (iOS) */
  html {
    -webkit-text-size-adjust: 100%;
  }

  :root {
    --background: 0 0% 100%;
    --foreground: 0 0% 3.9%;
    --card: 0 0% 100%;
    --card-foreground: 0 0% 3.9%;
    --popover: 0 0% 100%;
    --popover-foreground: 0 0% 3.9%;
    --primary: 0 0% 9%;
    --primary-foreground: 0 0% 98%;
    --secondary: 0 0% 96.1%;
    --secondary-foreground: 0 0% 9%;
    --muted: 0 0% 96.1%;
    --muted-foreground: 0 0% 45.1%;
    --accent: 0 0% 96.1%;
    --accent-foreground: 0 0% 9%;
    --destructive: 0 84.2% 60.2%;
    --destructive-foreground: 0 0% 98%;
    --border: 0 0% 89.8%;
    --input: 0 0% 89.8%;
    --ring: 0 0% 3.9%;
    --chart-1: 12 76% 61%;
    --chart-2: 173 58% 39%;
    --chart-3: 197 37% 24%;
    --chart-4: 43 74% 66%;
    --chart-5: 27 87% 67%;
    --radius: 0.5rem;

    /* Z-index scale - use these instead of arbitrary values */
    --z-base: 1;
    --z-above: 2; /* Just above siblings (badges, overlays) */
    --z-raised: 5; /* Slightly elevated (floating actions) */
    --z-elevated: 10; /* Cards, tooltips, popovers */
    --z-header: 20; /* Fixed headers, navbars */
    --z-overlay: 40; /* Overlays below sticky */
    --z-sticky: 50; /* Sticky elements */
    --z-dropdown: 100; /* Dropdowns, context menus */
    --z-modal: 1000; /* Modal dialogs */
    --z-modal-dropdown: 1100; /* Dropdowns inside modals */
    --z-toast: 1200; /* Toast notifications */

    /* Shadow & Radius scales - CANONICAL SOURCE: design-tokens.css
       --shadow-xs, --shadow-sm, --shadow-md, --shadow-lg, --shadow-xl, --shadow-2xl
       --radius-xs, --radius-sm, --radius-default, --radius-md, --radius-lg, --radius-xl, --radius-2xl, --radius-3xl, --radius-full */

    /* Additional shadows not in design-tokens.css */
    --shadow-modal:
      0 32px 64px -16px rgb(0, 0, 0, 0.35), 0 16px 32px -8px rgb(0, 0, 0, 0.25),
      0 0 1px rgb(0, 0, 0, 0.08);
    --shadow-focus: 0 0 0 3px rgb(99, 102, 241, 0.25);

    /* ===== COLOR TOKENS ===== */

    /* Text colors */
    --color-text-primary: #333;
    --color-text-secondary: #666;
    --color-text-tertiary: #6b7280; /* WCAG AA: 5.06:1 (was #9ca3af 2.54:1) */
    --color-text-muted: #666666; /* WCAG AA: 5.74:1 contrast on white */
    --color-text-inverse: #fff;

    /* Background colors */
    --color-bg-primary: #fff;
    --color-bg-secondary: #f9fafb;
    --color-bg-tertiary: #f5f5f5;
    --color-bg-hover: #f3f4f6;
    --color-bg-active: #e5e7eb;
    --color-bg-inverse: #1e293b; /* Dark bg for headers/banners */

    /* Border colors */
    --color-border: #64748b; /* WCAG AA: 3.92:1 (was #e5e7eb 1.24:1) - Slate-500 */
    --color-border-light: #cbd5e1;
    --color-border-dark: #475569;
    --color-border-muted: #94a3b8;

    /* Brand colors - Primary Blue */
    --color-brand-primary: #4a90e2;
    --color-brand-primary-hover: #3b82f6;
    --color-brand-primary-light: #f0f7ff;

    /* Brand colors - Iris Accent */
    --color-accent: #6366f1;
    --color-accent-hover: #4f46e5;
    --color-accent-light: #eef2ff;
    --color-accent-dark: #4338ca;
    --color-accent-iris: #818cf8;

    /* Brand colors - Indigo */
    --color-indigo: #6366f1;
    --color-indigo-light: rgb(99, 102, 241, 0.1);

    /* Button component tokens - direct values to avoid variable resolution issues */
    --color-primary: #4f46e5; /* WCAG AA: 6.39:1 (was #6366f1 4.47:1) - Indigo-600 */
    --color-primary-text: #fff;
    --color-primary-hover: #4338ca; /* Indigo-700 */
    --color-primary-active: #3730a3; /* Indigo-800 */
    --color-bg-base: #fff;
    --color-bg-muted: #f1f5f9; /* Slate-100 */
    --color-bg-subtle: #f8fafc; /* Slate-50 */
    --color-bg-emphasis: #e2e8f0; /* Slate-200 */
    --color-text-default: #333;
    --color-border-default: #cbd5e1;
    --color-border-emphasis: #94a3b8; /* Slate-500 */
    --color-error-text: #fff;
    --color-error-hover: #b91c1c; /* Red-700 */
    --color-success-text: #fff;
    --color-success-hover: #047857; /* Emerald-700 */

    /* Semantic colors - Success */
    --color-success: #047857; /* WCAG AA: 4.51:1 (was #10b981 2.54:1) - Emerald-700 */
    --color-success-light: #d1fae5;
    --color-success-dark: #065f46;
    --color-success-muted: #5a8a5a;
    --color-success-border: #c8e6c8;
    --color-success-bg: #f8faf8;
    --color-success-code: #1b5e20;

    /* Semantic colors - Error */
    --color-error: #dc2626; /* WCAG AA: 5.48:1 (was #ef4444 3.76:1) - Red-600 */
    --color-error-light: #fee2e2;
    --color-error-dark: #b91c1c;

    /* Semantic colors - Warning */
    --color-warning: #f59e0b;
    --color-warning-light: #fef3c7;
    --color-warning-dark: #d97706;

    /* Semantic colors - Info */
    --color-info: #3b82f6;
    --color-info-light: #dbeafe;

    /* Department colors - for badges and UI elements */
    --color-dept-engineering: #3b82f6;
    --color-dept-design: #8b5cf6;
    --color-dept-product: #10b981;
    --color-dept-marketing: #6366f1;
    --color-dept-legal: #6b7280;
    --color-dept-finance: #14b8a6;
    --color-dept-hr: #ec4899;
    --color-dept-operations: #f97316;

    /* Curator (purple theme) */
    --color-curator-primary: #9c27b0;
    --color-curator-hover: #7b1fa2;
    --color-curator-dark: #6a1b9a;
    --color-curator-light: #f3e5f5;
    --color-curator-lighter: #e1bee7;
    --color-curator-border: #ce93d8;

    /* ===== TAILWIND COLOR PALETTE TOKENS ===== */

    /* Slate scale - for neutral/gray UI elements */
    --color-slate-50: #f8fafc;
    --color-slate-100: #f1f5f9;
    --color-slate-200: #e2e8f0;
    --color-slate-300: #cbd5e1;
    --color-slate-500: #64748b;
    --color-slate-600: #475569;
    --color-slate-700: #334155;
    --color-slate-800: #1e293b;
    --color-slate-900: #0f172a;

    /* Code block colors - always dark for contrast */
    --color-code-bg: var(--color-slate-900);
    --color-code-text: var(--color-slate-100);
    --color-code-border: var(--color-slate-700);

    /* Gray scale */
    --color-gray-50: #f9fafb;
    --color-gray-100: #f3f4f6;
    --color-gray-200: #e5e7eb;
    --color-gray-300: #d1d5db;
    --color-gray-400: #9ca3af;
    --color-gray-500: #6b7280;
    --color-gray-600: #4b5563;
    --color-gray-700: #374151;
    --color-gray-800: #1f2937;

    /* Blue scale - for SOP type, links, info */
    --color-blue-50: #eff6ff;
    --color-blue-100: #dbeafe;
    --color-blue-200: #bfdbfe;
    --color-blue-300: #93c5fd;
    --color-blue-400: #60a5fa;
    --color-blue-500: #3b82f6;
    --color-blue-600: #2563eb;
    --color-blue-700: #1d4ed8;
    --color-blue-800: #1e40af;
    --color-blue-900: #1e3a5f;

    /* Green scale - for success states */
    --color-green-50: #f0fdf4;
    --color-green-100: #dcfce7;
    --color-green-200: #bbf7d0;
    --color-green-300: #86efac;
    --color-green-500: #22c55e;
    --color-green-600: #16a34a;
    --color-green-700: #15803d;
    --color-green-800: #166534;

    /* Emerald scale - for save buttons */
    --color-emerald-50: #ecfdf5;
    --color-emerald-100: #d1fae5;
    --color-emerald-200: #a7f3d0;
    --color-emerald-300: #6ee7b7;
    --color-emerald-400: #34d399;
    --color-emerald-500: #10b981;
    --color-emerald-600: #059669;
    --color-emerald-700: #047857;

    /* Amber scale - for framework type */
    --color-amber-100: #fef3c7;
    --color-amber-200: #fde68a;
    --color-amber-300: #fcd34d;
    --color-amber-400: #fbbf24;
    --color-amber-500: #f59e0b;
    --color-amber-600: #d97706;
    --color-amber-700: #b45309;

    /* Purple scale - for policy type, projects */
    --color-purple-100: #f3e8ff;
    --color-purple-200: #e9d5ff;
    --color-purple-300: #c4b5fd;
    --color-purple-600: #7c3aed;
    --color-purple-900: #581c87;

    /* Violet scale - for project hover states */
    --color-violet-50: #f5f3ff;
    --color-violet-100: #ede9fe;
    --color-violet-200: #ddd6fe;
    --color-violet-300: #c4b5fd;
    --color-violet-400: #a78bfa;
    --color-violet-500: #8b5cf6;
    --color-violet-600: #7c3aed;
    --color-violet-700: #6d28d9;
    --color-violet-900: #4c1d95;

    /* Red scale - for error/delete states */
    --color-red-50: #fef2f2;
    --color-red-100: #fee2e2;
    --color-red-200: #fecaca;
    --color-red-300: #fca5a5;
    --color-red-400: #f87171;
    --color-red-500: #ef4444;
    --color-red-600: #dc2626;
    --color-red-700: #b91c1c;

    /* Yellow scale - for warning states */
    --color-yellow-50: #fefce8;
    --color-yellow-100: #fef9c3;
    --color-yellow-200: #fef08a;
    --color-yellow-500: #eab308;
    --color-yellow-600: #ca8a04;
    --color-yellow-700: #a16207;

    /* Teal scale - for project types */
    --color-teal-50: #f0fdfa;
    --color-teal-100: #ccfbf1;
    --color-teal-500: #14b8a6;
    --color-teal-600: #0d9488;

    /* Stone scale - for neutral/archived states */
    --color-stone-100: #f5f5f4;
    --color-stone-200: #e7e5e4;
    --color-stone-300: #d6d3d1;
    --color-stone-500: #78716c;
    --color-stone-600: #57534e;

    /* Indigo extended scale */
    --color-indigo-50: #eef2ff;
    --color-indigo-100: #e0e7ff;
    --color-indigo-300: #a5b4fc;
    --color-indigo-400: #818cf8;
    --color-indigo-500: #6366f1;
    --color-indigo-600: #4f46e5;
    --color-indigo-700: #4338ca;
    --color-indigo-900: #312e81;
    --color-indigo-rgb: 99, 102, 241; /* For rgba() usage */

    /* ===== RGB COLOR TOKENS (for alpha transparency) ===== */

    /* Use with rgba(var(--color-xxx-rgb), opacity) */

    /* Core colors - RGB */
    --color-black-rgb: 0, 0, 0;
    --color-white-rgb: 255, 255, 255;

    /* Brand colors - RGB */
    --color-blue-500-rgb: 59, 130, 246;
    --color-blue-600-rgb: 37, 99, 235;
    --color-purple-500-rgb: 139, 92, 246;
    --color-purple-600-rgb: 124, 58, 237;
    --color-amber-500-rgb: 245, 158, 11;
    --color-amber-600-rgb: 217, 119, 6;
    --color-green-500-rgb: 34, 197, 94;
    --color-emerald-500-rgb: 16, 185, 129;
    --color-emerald-600-rgb: 5, 150, 105;
    --color-red-500-rgb: 239, 68, 68;
    --color-red-600-rgb: 220, 38, 38;
    --color-slate-200-rgb: 226, 232, 240;
    --color-slate-500-rgb: 100, 116, 139;
    --color-slate-600-rgb: 71, 85, 105;
    --color-slate-800-rgb: 30, 41, 59;
    --color-gray-900-rgb: 17, 24, 39;

    /* Semantic colors - RGB */
    --color-success-rgb: 16, 185, 129;
    --color-error-rgb: 239, 68, 68;
    --color-warning-rgb: 245, 158, 11;
    --color-info-rgb: 59, 130, 246;

    /* ===== OVERLAY TOKENS ===== */

    /* Pre-computed overlay backgrounds for common use cases */

    /* Dark overlays (black with alpha) */
    --overlay-black-5: rgb(0, 0, 0, 0.05);
    --overlay-black-8: rgb(0, 0, 0, 0.08);
    --overlay-black-10: rgb(0, 0, 0, 0.1);
    --overlay-black-15: rgb(0, 0, 0, 0.15);
    --overlay-black-20: rgb(0, 0, 0, 0.2);
    --overlay-black-30: rgb(0, 0, 0, 0.3);
    --overlay-black-40: rgb(0, 0, 0, 0.4);
    --overlay-black-50: rgb(0, 0, 0, 0.5);
    --overlay-black-60: rgb(0, 0, 0, 0.6);
    --overlay-black-70: rgb(0, 0, 0, 0.7);
    --overlay-black-80: rgb(0, 0, 0, 0.8);

    /* Light overlays (white with alpha) */
    --overlay-white-5: rgb(255, 255, 255, 0.05);
    --overlay-white-8: rgb(255, 255, 255, 0.08);
    --overlay-white-10: rgb(255, 255, 255, 0.1);
    --overlay-white-15: rgb(255, 255, 255, 0.15);
    --overlay-white-20: rgb(255, 255, 255, 0.2);
    --overlay-white-25: rgb(255, 255, 255, 0.25);
    --overlay-white-30: rgb(255, 255, 255, 0.3);
    --overlay-white-40: rgb(255, 255, 255, 0.4);
    --overlay-white-50: rgb(255, 255, 255, 0.5);
    --overlay-white-60: rgb(255, 255, 255, 0.6);
    --overlay-white-80: rgb(255, 255, 255, 0.8);
    --overlay-white-90: rgb(255, 255, 255, 0.9);
    --overlay-white-95: rgb(255, 255, 255, 0.95);

    /* Color overlays (for badges, highlights, etc.) */
    --overlay-blue-10: rgb(59, 130, 246, 0.1);
    --overlay-blue-15: rgb(59, 130, 246, 0.15);
    --overlay-blue-20: rgb(59, 130, 246, 0.2);
    --overlay-purple-10: rgb(139, 92, 246, 0.1);
    --overlay-purple-15: rgb(139, 92, 246, 0.15);
    --overlay-purple-20: rgb(139, 92, 246, 0.2);
    --overlay-amber-10: rgb(245, 158, 11, 0.1);
    --overlay-amber-15: rgb(245, 158, 11, 0.15);
    --overlay-amber-20: rgb(245, 158, 11, 0.2);
    --overlay-orange-30: rgb(249, 115, 22, 0.3);
    --overlay-orange-40: rgb(249, 115, 22, 0.4);
    --overlay-orange-60: rgb(249, 115, 22, 0.6);
    --overlay-green-10: rgb(34, 197, 94, 0.1);
    --overlay-green-30: rgb(34, 197, 94, 0.3);
    --overlay-green-15: rgb(34, 197, 94, 0.15);
    --overlay-green-20: rgb(34, 197, 94, 0.2);
    --overlay-emerald-10: rgb(16, 185, 129, 0.1);
    --overlay-emerald-15: rgb(16, 185, 129, 0.15);
    --overlay-emerald-20: rgb(16, 185, 129, 0.2);
    --overlay-red-10: rgb(239, 68, 68, 0.1);
    --overlay-red-15: rgb(239, 68, 68, 0.15);
    --overlay-red-20: rgb(239, 68, 68, 0.2);
    --overlay-indigo-10: rgb(99, 102, 241, 0.1);
    --overlay-indigo-15: rgb(99, 102, 241, 0.15);
    --overlay-indigo-20: rgb(99, 102, 241, 0.2);
    --overlay-indigo-25: rgb(99, 102, 241, 0.25);

    /* Provider brand colors */
    --color-provider-openrouter: #6366f1;
    --color-provider-anthropic: #d4a574;

    /* Red scale - for errors, danger states */
    --color-red-500: #ef4444;

    /* Knowledge Base (dark theme) */
    --color-kb-bg-primary: #1a1a2e;
    --color-kb-bg-secondary: #1e1e32;
    --color-kb-bg-tertiary: #16162a;
    --color-kb-bg-hover: #252540;
    --color-kb-border: #2d2d44;
    --color-kb-border-light: #3d3d5c;
    --color-kb-text-primary: #fff;
    --color-kb-text-secondary: #ccd;
    --color-kb-text-muted: #88a;
    --color-kb-text-dim: #66a;
    --color-kb-text-subtle: #aac;
    --color-kb-accent: #4a4ae8;
    --color-kb-accent-hover: #5a5af8;
    --color-kb-error: #ff6b6b;

    /* KB Category badges */
    --color-kb-cat-technical-bg: #2d4a7c;
    --color-kb-cat-technical-text: #6fa8dc;
    --color-kb-cat-ux-bg: #5c2d7c;
    --color-kb-cat-ux-text: #b47cdc;
    --color-kb-cat-feature-bg: #2d7c4a;
    --color-kb-cat-feature-text: #6fdc8f;
    --color-kb-cat-policy-bg: #7c5c2d;
    --color-kb-cat-policy-text: #dcb46f;
    --color-kb-cat-process-bg: #7c2d5c;
    --color-kb-cat-process-text: #dc6fb4;
    --color-kb-cat-role-bg: #2d7c7c;
    --color-kb-cat-role-text: #6fdcdc;
    --color-kb-cat-framework-bg: #4a2d7c;
    --color-kb-cat-framework-text: #8f6fdc;
    --color-kb-cat-sop-bg: #7c7c2d;
    --color-kb-cat-sop-text: #dcdc6f;

    /* KB Status badges */
    --color-kb-status-superseded-bg: #7c5c2d;
    --color-kb-status-superseded-text: #dcb46f;
    --color-kb-status-archived-bg: #4a4a5c;
    --color-kb-status-archived-text: #99a;

    /* ===== SIDEBAR TOKENS (Perplexity-style) ===== */
    --sidebar-width-collapsed: 56px;
    --sidebar-width-expanded: 280px;

    /* Smooth transition for width changes */
    --sidebar-transition: 0.25s ease-out;
    --sidebar-hover-delay: 80ms;
    --sidebar-collapse-delay: 200ms;

    /* Sidebar colors - Perplexity light theme (clean white) */
    --sidebar-bg: #fafafa;
    --sidebar-bg-solid: #fafafa;
    --sidebar-border: #e8e8e8;
    --sidebar-text-primary: #1a1a1a;
    --sidebar-text-secondary: #666;
    --sidebar-text-muted: #999;
    --sidebar-hover-bg: rgb(0, 0, 0, 0.04);
    --sidebar-active-bg: rgb(0, 0, 0, 0.06);
    --sidebar-active-border: #6366f1;
    --sidebar-icon-color: #666;
    --sidebar-icon-active: #1a1a1a;
    --sidebar-scrollbar-thumb: rgb(0, 0, 0, 0.12);
    --sidebar-scrollbar-track: transparent;

    /* Sidebar button - Perplexity teal accent */
    --sidebar-btn-primary: #20b2aa;
    --sidebar-btn-primary-hover: #1a9994;
    --sidebar-btn-primary-shadow: rgb(32, 178, 170, 0.25);

    /* Aurora background colors */
    --white: #fff;
    --black: #000;
    --transparent: transparent;
    --blue-300: #93c5fd;
    --blue-400: #60a5fa;
    --indigo-300: #a5b4fc;

    /* ===== DELIBERATION VIEW TOKENS ===== */

    /* Stage-specific colors */
    --stage1-bg-gradient-start: #eff6ff;
    --stage1-bg-gradient-end: #dbeafe;
    --stage1-border: #93c5fd;
    --stage1-text-primary: #1e40af;
    --stage1-shadow-color: rgb(59, 130, 246, 0.15);
    --stage2-bg-gradient-start: #faf5ff;
    --stage2-bg-gradient-end: #f3e8ff;
    --stage2-border: #e9d5ff;
    --stage2-text-primary: #7c3aed;
    --stage2-shadow-color: rgb(139, 92, 246, 0.15);
    --stage3-bg-gradient-start: #ecfdf5;
    --stage3-bg-gradient-end: #d1fae5;
    --stage3-border: #6ee7b7;
    --stage3-text-primary: #065f46;
    --stage3-shadow-color: rgb(16, 185, 129, 0.15);

    /* Avatar states */
    --avatar-waiting-bg: #f9fafb;
    --avatar-waiting-border: #e5e7eb;
    --avatar-thinking-bg: #eff6ff;
    --avatar-thinking-border: #3b82f6;
    --avatar-thinking-ring: rgb(59, 130, 246, 0.2);
    --avatar-complete-bg: #ecfdf5;
    --avatar-complete-border: #10b981;
    --avatar-reviewing-bg: #eef2ff;
    --avatar-reviewing-border: #6366f1;
    --avatar-reviewing-ring: rgb(99, 102, 241, 0.2);

    /* Thinking stream */
    --thinking-stream-bg: #1e293b;
    --thinking-stream-border: #334155;
    --thinking-stream-text: #94a3b8;
    --thinking-stream-cursor: #3b82f6;

    /* Insight cards */
    --insight-gap-bg: #eef2ff;
    --insight-gap-border: #6366f1;
    --insight-gap-text: #3730a3;
    --insight-gap-button-bg: #f5f3ff;
    --insight-gap-button-hover: #eef2ff;
    --insight-consensus-bg: #d1fae5;
    --insight-consensus-border: #10b981;
    --insight-consensus-text: #065f46;
    --insight-tension-bg: #fee2e2;
    --insight-tension-border: #ef4444;
    --insight-tension-text: #991b1b;
    --insight-context-bg: #dbeafe;
    --insight-context-border: #3b82f6;
    --insight-context-text: #1e40af;

    /* Stage progress */
    --stage-progress-bg: #e5e7eb;
    --stage-progress-complete: #10b981;
    --stage-progress-text: #6b7280;

    /* Overlays */
    --overlay-bg: rgb(255, 255, 255, 0.95);
    --overlay-shimmer: rgb(255, 255, 255, 0.4);

    /* Skeleton loading - subtle shimmer animation */
    --skeleton-base: #e2e8f0; /* slate-200 - matches bg-secondary feel */
    --skeleton-shimmer: #f1f5f9; /* slate-100 - subtle lighter pulse */
  }
}

/* =============================================================================
   LIGHT MODE TOKENS - Explicit override for prefers-color-scheme: dark
   When user explicitly chooses light mode, this overrides system preference
   ============================================================================= */
html.light {
  --color-text-primary: #333;
  --color-text-secondary: #666;
  --color-text-tertiary: #9ca3af;
  --color-text-muted: #666666; /* WCAG AA: 5.74:1 contrast on white */
  --color-bg-primary: #fff;
  --color-bg-secondary: #f9fafb;
  --color-bg-tertiary: #f5f5f5;
  --color-bg-hover: #f3f4f6;
  --color-bg-active: #e5e7eb;
  --color-border: #e5e7eb;
  --color-border-light: #f1f5f9;
  --color-border-dark: #d1d5db;
}

/* =============================================================================
   DARK MODE TOKENS - Outside @layer for proper specificity
   Applied via next-themes ThemeProvider (class="dark" on html element)
   ============================================================================= */
html.dark,
.dark {
  --background: 0 0% 3.9%;
  --foreground: 0 0% 98%;
  --card: 0 0% 3.9%;
  --card-foreground: 0 0% 98%;
  --popover: 0 0% 3.9%;
  --popover-foreground: 0 0% 98%;
  --primary: 0 0% 98%;
  --primary-foreground: 0 0% 9%;
  --secondary: 0 0% 14.9%;
  --secondary-foreground: 0 0% 98%;
  --muted: 0 0% 14.9%;
  --muted-foreground: 0 0% 63.9%;
  --accent: 0 0% 14.9%;
  --accent-foreground: 0 0% 98%;
  --destructive: 0 62.8% 30.6%;
  --destructive-foreground: 0 0% 98%;
  --border: 0 0% 14.9%;
  --input: 0 0% 14.9%;
  --ring: 0 0% 83.1%;
  --chart-1: 220 70% 50%;
  --chart-2: 160 60% 45%;
  --chart-3: 30 80% 55%;
  --chart-4: 280 65% 60%;
  --chart-5: 340 75% 55%;

  /* ===== DARK MODE COLOR TOKENS ===== */

  /* Text colors - improved contrast for WCAG AA compliance */
  --color-text-primary: #f8fafc; /* slate-50 - brightest for primary text */
  --color-text-secondary: #cbd5e1; /* slate-300 - clearly readable secondary */
  --color-text-tertiary: #94a3b8; /* slate-400 - labels, captions (was too dark) */
  --color-text-muted: #64748b; /* slate-500 - very subtle, decorative only */
  --color-text-inverse: #fff; /* White text on inverse (dark) backgrounds */

  /* Background colors */
  --color-bg-primary: #0f172a;
  --color-bg-secondary: #1e293b;
  --color-bg-tertiary: #334155;
  --color-bg-hover: #334155;
  --color-bg-active: #475569;
  --color-bg-inverse: #1e293b; /* Slightly lighter for dark mode contrast */

  /* Border colors */
  --color-border: #334155;
  --color-border-light: #1e293b;
  --color-border-dark: #475569;
  --color-border-muted: #334155;

  /* Brand colors - slightly brighter for dark mode */
  --color-brand-primary: #60a5fa;
  --color-brand-primary-hover: #3b82f6;
  --color-brand-primary-light: rgb(59, 130, 246, 0.15);

  /* Button component tokens - dark mode (direct values) */
  --color-primary: #6366f1; /* Indigo-500 */
  --color-primary-text: #fff;
  --color-primary-hover: #818cf8; /* Indigo-400 - brighter for dark */
  --color-primary-active: #a5b4fc; /* Indigo-300 */
  --color-bg-base: #0f172a;
  --color-bg-muted: #334155; /* Dark slate */
  --color-bg-subtle: #1e293b;
  --color-bg-emphasis: #475569;
  --color-text-default: #f1f5f9;
  --color-border-default: #334155;
  --color-border-emphasis: #64748b;
  --color-error-text: #fff;
  --color-error-hover: #ef4444; /* Red-500 */
  --color-success-text: #fff;
  --color-success-hover: #10b981; /* Emerald-500 */

  /* Semantic colors - adjusted for dark */
  --color-success-light: rgb(16, 185, 129, 0.15);
  --color-error-light: rgb(239, 68, 68, 0.15);
  --color-warning-light: rgb(245, 158, 11, 0.15);
  --color-info-light: rgb(59, 130, 246, 0.15);

  /* Slate scale - inverted for dark mode UI */
  --color-slate-50: #1e293b;
  --color-slate-100: #334155;
  --color-slate-200: #475569;
  --color-slate-300: #64748b;
  --color-slate-500: #94a3b8;
  --color-slate-600: #cbd5e1;
  --color-slate-700: #e2e8f0;
  --color-slate-800: #f1f5f9;
  --color-slate-900: #f8fafc;

  /* Code blocks - remain dark even in dark mode for contrast */
  --color-code-bg: #0f172a;
  --color-code-text: #e2e8f0;
  --color-code-border: #334155;

  /* Stage colors - dark variants */
  --stage1-bg-gradient-start: #1e293b;
  --stage1-bg-gradient-end: #0f172a;
  --stage1-border: #3b82f6;
  --stage1-text-primary: #93c5fd;
  --stage2-bg-gradient-start: #1e293b;
  --stage2-bg-gradient-end: #0f172a;
  --stage2-border: #8b5cf6;
  --stage2-text-primary: #c4b5fd;
  --stage2-shadow-color: rgb(139, 92, 246, 0.25);
  --stage3-bg-gradient-start: #1e293b;
  --stage3-bg-gradient-end: #0f172a;
  --stage3-border: #10b981;
  --stage3-text-primary: #6ee7b7;

  /* Overlays - dark variants */
  --overlay-bg: rgb(15, 23, 42, 0.95);
  --overlay-shimmer: rgb(255, 255, 255, 0.05);

  /* Dark mode overlay tokens - inverted for dark backgrounds */

  /* In dark mode, use white overlays to lighten, black to darken further */
  --overlay-black-5: rgb(0, 0, 0, 0.15);
  --overlay-black-8: rgb(0, 0, 0, 0.2);
  --overlay-black-10: rgb(0, 0, 0, 0.25);
  --overlay-black-15: rgb(0, 0, 0, 0.3);
  --overlay-black-20: rgb(0, 0, 0, 0.35);
  --overlay-black-30: rgb(0, 0, 0, 0.45);
  --overlay-black-40: rgb(0, 0, 0, 0.5);
  --overlay-black-50: rgb(0, 0, 0, 0.6);
  --overlay-white-5: rgb(255, 255, 255, 0.05);
  --overlay-white-8: rgb(255, 255, 255, 0.08);
  --overlay-white-10: rgb(255, 255, 255, 0.1);
  --overlay-white-15: rgb(255, 255, 255, 0.15);
  --overlay-white-20: rgb(255, 255, 255, 0.2);
  --overlay-white-30: rgb(255, 255, 255, 0.25);
  --overlay-white-40: rgb(255, 255, 255, 0.3);
  --overlay-white-50: rgb(255, 255, 255, 0.4);
  --overlay-white-60: rgb(255, 255, 255, 0.5);
  --overlay-white-80: rgb(255, 255, 255, 0.6);
  --overlay-white-90: rgb(255, 255, 255, 0.7);
  --overlay-white-95: rgb(255, 255, 255, 0.8);

  /* Color overlays - same values work in dark mode */
  --overlay-blue-10: rgb(59, 130, 246, 0.15);
  --overlay-blue-15: rgb(59, 130, 246, 0.2);
  --overlay-blue-20: rgb(59, 130, 246, 0.25);
  --overlay-purple-10: rgb(139, 92, 246, 0.15);
  --overlay-purple-15: rgb(139, 92, 246, 0.2);
  --overlay-purple-20: rgb(139, 92, 246, 0.25);
  --overlay-amber-10: rgb(245, 158, 11, 0.15);
  --overlay-amber-15: rgb(245, 158, 11, 0.2);
  --overlay-amber-20: rgb(245, 158, 11, 0.25);
  --overlay-orange-30: rgb(249, 115, 22, 0.35);
  --overlay-orange-40: rgb(249, 115, 22, 0.45);
  --overlay-orange-60: rgb(249, 115, 22, 0.65);
  --overlay-green-10: rgb(34, 197, 94, 0.15);
  --overlay-green-30: rgb(34, 197, 94, 0.35);
  --overlay-green-15: rgb(34, 197, 94, 0.2);
  --overlay-green-20: rgb(34, 197, 94, 0.25);
  --overlay-emerald-10: rgb(16, 185, 129, 0.15);
  --overlay-emerald-15: rgb(16, 185, 129, 0.2);
  --overlay-emerald-20: rgb(16, 185, 129, 0.25);
  --overlay-red-10: rgb(239, 68, 68, 0.15);
  --overlay-red-15: rgb(239, 68, 68, 0.2);
  --overlay-red-20: rgb(239, 68, 68, 0.25);
  --overlay-indigo-10: rgb(99, 102, 241, 0.15);
  --overlay-indigo-15: rgb(99, 102, 241, 0.2);
  --overlay-indigo-20: rgb(99, 102, 241, 0.25);
  --overlay-indigo-25: rgb(99, 102, 241, 0.3);

  /* Skeleton loading - dark mode (subtle, not jarring) */
  --skeleton-base: #1e293b; /* slate-800 - dark base */
  --skeleton-shimmer: #334155; /* slate-700 - subtle lighter shimmer */

  /* Glass morphism - dark mode */
  --glass-bg: rgb(30, 41, 59, 0.85);
  --glass-bg-focus: rgb(30, 41, 59, 0.95);
  --glass-border: rgb(51, 65, 85, 0.6);
  --glass-shadow: 0 4px 16px rgb(0, 0, 0, 0.3);

  /* Sidebar - dark mode (Perplexity-style dark) */
  --sidebar-bg: #171717;
  --sidebar-bg-solid: #171717;
  --sidebar-border: #2a2a2a;
  --sidebar-text-primary: #f5f5f5;
  --sidebar-text-secondary: #a0a0a0;
  --sidebar-text-muted: #666;
  --sidebar-hover-bg: rgb(255, 255, 255, 0.06);
  --sidebar-active-bg: rgb(255, 255, 255, 0.08);
  --sidebar-icon-color: #a0a0a0;
  --sidebar-icon-active: #f5f5f5;
  --sidebar-scrollbar-thumb: rgb(255, 255, 255, 0.15);
}

@layer base {
  * {
    border-color: hsl(var(--border));
  }

  body {
    background-color: hsl(var(--background));
    color: hsl(var(--foreground));
  }
}

/* Aurora animation keyframes */
@keyframes aurora {
  from {
    background-position:
      50% 50%,
      50% 50%;
  }

  to {
    background-position:
      350% 50%,
      350% 50%;
  }
}

.animate-aurora {
  animation: aurora 60s linear infinite;
}

/* ============================================================================
   MOBILE LANDSCAPE ORIENTATION SUPPORT
   ============================================================================ */

@media (max-width: 900px) and (orientation: landscape) {
  /* Reduce vertical heights in landscape - use higher specificity */
  .chat-interface .input-form {
    padding: 10px 16px;
    gap: 8px;
  }

  .chat-interface .message-input,
  textarea.message-input {
    min-height: 40px;
    max-height: 120px;
  }

  /* Sidebar narrower in landscape */
  .app-container .sidebar,
  aside.sidebar {
    width: 240px;
    max-width: 240px;
  }

  /* Messages container - maximize vertical space */
  .chat-interface .messages-container {
    padding: 12px 16px;
  }

  .messages-container .message-group {
    margin-block-end: 16px;
  }

  /* Landing hero - horizontal layout in landscape */
  .landing-page .landing-hero,
  section.landing-hero {
    max-width: 90vw;
    gap: 16px;
  }

  /* Modal optimization - reduce height */
  [data-state='open'].app-modal-content,
  .modal-overlay .mc-panel {
    max-height: 85vh;
  }

  /* Settings sidebar - horizontal in landscape */
  .settings-container .settings-sidebar,
  nav.settings-sidebar {
    flex-direction: row;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    scrollbar-width: none;
  }

  .settings-sidebar::-webkit-scrollbar {
    display: none;
  }

  /* Reduce padding on modals */
  .mc-panel .mc-header,
  .mc-panel .mc-content {
    padding: 12px 16px;
  }

  /* Context bar stays compact */
  .chat-interface .context-bar {
    gap: 6px;
  }
}

/* iPhone SE landscape specific (568px wide) */
@media (max-height: 400px) and (orientation: landscape) {
  .chat-interface .message-input,
  textarea.message-input {
    min-height: 36px;
    max-height: 80px;
  }

  .input-form button.send-button,
  .input-form button.stop-button {
    padding: 8px 12px;
    font-size: 12px;
  }

  .chat-interface .input-form {
    padding: 8px 12px;
  }

  .modal-overlay .mc-panel,
  [data-state='open'].mc-panel {
    height: 100vh;
    max-height: 100vh;
    border-radius: 0;
  }
}

/* ============================================================================
   TOUCH TARGET MINIMUM SIZE UTILITIES
   ============================================================================ */

@media (max-width: 768px) {
  /* Ensure minimum 44x44px touch targets on mobile */

  /* Components with custom sizing should use .no-touch-target class to opt out */
  button:not(.no-touch-target),
  .button:not(.no-touch-target),
  [role='button']:not(.no-touch-target),
  a.clickable:not(.no-touch-target) {
    min-width: 44px;
    min-height: 44px;
  }

  /* Icon-only buttons need internal padding */
  button.icon-only,
  .button.icon-only,
  button.icon-btn,
  .icon-btn {
    padding: 10px;
  }

  /* Ensure adequate spacing between touch targets */
  .touch-spacing > * + * {
    margin-inline-start: 8px;
  }
}

/* Utility class to force touch target size */
.touch-target {
  min-width: 44px;
  min-height: 44px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

/* ============================================================================
   SMOOTH SCROLLING & MOBILE SCROLL BEHAVIOR
   ============================================================================ */

html {
  scroll-behavior: smooth;
}

/* iOS-style momentum scrolling */
.messages-container,
.sidebar,
.mc-content,
.settings-main {
  -webkit-overflow-scrolling: touch;
  overscroll-behavior: contain;
}

/* Hide scrollbars on mobile (iOS pattern) */
@media (max-width: 768px) {
  .messages-container::-webkit-scrollbar,
  .sidebar::-webkit-scrollbar,
  .mc-content::-webkit-scrollbar {
    display: none;
  }

  .messages-container,
  .sidebar,
  .mc-content {
    scrollbar-width: none;
    -ms-overflow-style: none;
  }
}

/* Respect reduced motion preference - !important required for WCAG 2.1 AA compliance */
/* stylelint-disable declaration-no-important */
@media (prefers-reduced-motion: reduce) {
  *,
  ::before,
  ::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}
/* stylelint-enable declaration-no-important */

/* ============================================================================
   MOBILE TYPOGRAPHY REFINEMENTS
   ============================================================================ */

@media (max-width: 768px) {
  /* Prevent iOS zoom on input focus - 16px minimum prevents Safari auto-zoom */
  /* stylelint-disable declaration-no-important */
  input[type='text'],
  input[type='email'],
  input[type='password'],
  input[type='search'],
  textarea,
  select {
    font-size: 16px !important;
  }
  /* stylelint-enable declaration-no-important */

  /* Enable iOS text size adjustment */
  body {
    -webkit-text-size-adjust: 100%;
    text-size-adjust: 100%;
  }
}

/* ============================================================================
   THEME & INTERACTIVE TRANSITIONS
   ============================================================================ */

/* Only transition theme-aware elements, not everything */
.theme-transition {
  transition:
    background-color 0.15s ease-out,
    border-color 0.15s ease-out,
    color 0.15s ease-out;
}

/* Interactive element transitions */
button,
a,
[role='button'],
.btn,
.button {
  transition:
    background-color 0.15s ease,
    border-color 0.15s ease,
    transform 0.1s ease,
    box-shadow 0.15s ease,
    opacity 0.15s ease;
}

/* Disable transitions for reduced motion preference */
@media (prefers-reduced-motion: reduce) {
  button,
  a,
  [role='button'],
  .btn,
  .button,
  .theme-transition {
    transition: none;
  }
}

/* ============================================================================
   VISUAL DENSITY OPTIMIZATION (Mobile)
   These are utility classes applied to elements that need mobile density.
   Using double-class specificity to ensure they override component defaults.
   ============================================================================ */

@media (max-width: 768px) {
  /* Tighter spacing on mobile for more content visibility */
  .gap-tight.gap-tight {
    gap: 8px;
  }

  /* Compact padding utility */
  .p-compact.p-compact {
    padding: 12px;
  }

  /* Smaller font for secondary text */
  span.text-secondary,
  span.text-muted,
  p.text-secondary,
  p.text-muted,
  .text-secondary.text-secondary,
  .text-muted.text-muted {
    font-size: 13px;
  }

  /* Reduce line height for denser content */
  .leading-tight-mobile.leading-tight-mobile {
    line-height: 1.4;
  }
}

@media (max-width: 480px) {
  /* Even tighter on small phones */
  .gap-tight.gap-tight {
    gap: 6px;
  }

  .p-compact.p-compact {
    padding: 10px;
  }

  span.text-secondary,
  span.text-muted,
  p.text-secondary,
  p.text-muted,
  .text-secondary.text-secondary,
  .text-muted.text-muted {
    font-size: 12px;
  }
}

/* ============================================================================
   BUTTON MICRO-INTERACTIONS
   ============================================================================ */

/* Subtle scale on hover for premium feel */
button:not(:disabled):hover,
.button:not(:disabled):hover,
[role='button']:not(:disabled):hover {
  transform: translateY(-1px);
}

button:not(:disabled):active,
.button:not(:disabled):active,
[role='button']:not(:disabled):active {
  transform: translateY(0) scale(0.98);
}

/* Disable hover transforms on mobile (touch devices) */
@media (hover: none) {
  button:hover,
  .button:hover,
  [role='button']:hover {
    transform: none;
  }

  button:active,
  .button:active,
  [role='button']:active {
    transform: scale(0.98);
  }
}

/* ============================================================================
   BUTTON VARIANT CLASSES - Premium $25M Quality

   These styles are OUTSIDE @layer to ensure they have higher specificity than
   Tailwind utilities. This is intentional - button variants need to override
   any conflicting utility classes applied via CVA.
   ============================================================================ */

/* Primary Button - Indigo with premium shadow */
button.btn-variant-default,
.btn-variant-default {
  padding: 12px 28px;
  font-size: 14px;
  font-weight: 500;
  letter-spacing: -0.01em;
  border-radius: 12px;
  min-height: 44px;
  background-color: var(--color-primary);
  color: var(--color-primary-text);
  box-shadow:
    0 1px 3px rgb(99, 102, 241, 0.3),
    0 2px 8px rgb(99, 102, 241, 0.15),
    inset 0 1px 0 rgb(255, 255, 255, 0.1);
}

button.btn-variant-default:hover:not(:disabled),
.btn-variant-default:hover:not(:disabled) {
  background-color: var(--color-primary-hover);
  box-shadow:
    0 2px 6px rgb(99, 102, 241, 0.35),
    0 4px 12px rgb(99, 102, 241, 0.2),
    inset 0 1px 0 rgb(255, 255, 255, 0.15);
  transform: translateY(-1px);
}

button.btn-variant-default:active:not(:disabled),
.btn-variant-default:active:not(:disabled) {
  background-color: var(--color-primary-active);
  transform: translateY(0) scale(0.98);
  box-shadow:
    0 1px 2px rgb(99, 102, 241, 0.2),
    inset 0 1px 0 rgb(255, 255, 255, 0.05);
}

/* Secondary Button - Muted gray with subtle depth */
button.btn-variant-secondary,
.btn-variant-secondary {
  padding: 12px 28px;
  font-size: 14px;
  font-weight: 500;
  letter-spacing: -0.01em;
  border-radius: 12px;
  min-height: 44px;
  background-color: var(--color-bg-muted);
  color: var(--color-text-default);
  box-shadow: 0 1px 2px rgb(0, 0, 0, 0.05);
}

button.btn-variant-secondary:hover:not(:disabled),
.btn-variant-secondary:hover:not(:disabled) {
  background-color: var(--color-bg-emphasis);
  box-shadow: 0 2px 4px rgb(0, 0, 0, 0.08);
  transform: translateY(-1px);
}

button.btn-variant-secondary:active:not(:disabled),
.btn-variant-secondary:active:not(:disabled) {
  transform: translateY(0) scale(0.98);
}

/* Outline Button - Bordered with clean look */
button.btn-variant-outline,
.btn-variant-outline {
  padding: 12px 28px;
  font-size: 14px;
  font-weight: 500;
  letter-spacing: -0.01em;
  border-radius: 12px;
  min-height: 44px;
  background-color: var(--color-bg-base);
  color: var(--color-text-default);
  border: 1px solid var(--color-border-default);
  box-shadow: 0 1px 2px rgb(0, 0, 0, 0.04);
}

button.btn-variant-outline:hover:not(:disabled),
.btn-variant-outline:hover:not(:disabled) {
  background-color: var(--color-bg-subtle);
  border-color: var(--color-border-emphasis);
  box-shadow: 0 2px 4px rgb(0, 0, 0, 0.06);
  transform: translateY(-1px);
}

button.btn-variant-outline:active:not(:disabled),
.btn-variant-outline:active:not(:disabled) {
  transform: translateY(0) scale(0.98);
}

/* Ghost Button - Minimal with subtle hover */
button.btn-variant-ghost,
.btn-variant-ghost {
  padding: 12px 28px;
  font-size: 14px;
  font-weight: 500;
  letter-spacing: -0.01em;
  border-radius: 12px;
  min-height: 44px;
  background-color: transparent;
  color: var(--color-text-default);
}

button.btn-variant-ghost:hover:not(:disabled),
.btn-variant-ghost:hover:not(:disabled) {
  background-color: var(--color-bg-muted);
}

button.btn-variant-ghost:active:not(:disabled),
.btn-variant-ghost:active:not(:disabled) {
  transform: scale(0.98);
}

/* Destructive Button - Red with warning presence */
button.btn-variant-destructive,
.btn-variant-destructive {
  padding: 12px 28px;
  font-size: 14px;
  font-weight: 500;
  letter-spacing: -0.01em;
  border-radius: 12px;
  min-height: 44px;
  background-color: var(--color-error);
  color: var(--color-error-text);
  box-shadow:
    0 1px 3px rgb(239, 68, 68, 0.3),
    0 2px 8px rgb(239, 68, 68, 0.15);
}

button.btn-variant-destructive:hover:not(:disabled),
.btn-variant-destructive:hover:not(:disabled) {
  background-color: var(--color-error-hover);
  box-shadow:
    0 2px 6px rgb(239, 68, 68, 0.35),
    0 4px 12px rgb(239, 68, 68, 0.2);
  transform: translateY(-1px);
}

button.btn-variant-destructive:active:not(:disabled),
.btn-variant-destructive:active:not(:disabled) {
  transform: translateY(0) scale(0.98);
}

/* Success Button - Green with positive presence */
button.btn-variant-success,
.btn-variant-success {
  padding: 12px 28px;
  font-size: 14px;
  font-weight: 500;
  letter-spacing: -0.01em;
  border-radius: 12px;
  min-height: 44px;
  background-color: var(--color-success);
  color: var(--color-success-text);
  box-shadow:
    0 1px 3px rgb(16, 185, 129, 0.3),
    0 2px 8px rgb(16, 185, 129, 0.15);
}

button.btn-variant-success:hover:not(:disabled),
.btn-variant-success:hover:not(:disabled) {
  background-color: var(--color-success-hover);
  box-shadow:
    0 2px 6px rgb(16, 185, 129, 0.35),
    0 4px 12px rgb(16, 185, 129, 0.2);
  transform: translateY(-1px);
}

button.btn-variant-success:active:not(:disabled),
.btn-variant-success:active:not(:disabled) {
  transform: translateY(0) scale(0.98);
}

/* Link Button - Text style */
button.btn-variant-link,
.btn-variant-link {
  padding: 8px 16px;
  font-size: 14px;
  font-weight: 500;
  letter-spacing: -0.01em;
  border-radius: 8px;
  min-height: 36px;
  background-color: transparent;
  color: var(--color-primary);
  text-decoration: none;
}

button.btn-variant-link:hover:not(:disabled),
.btn-variant-link:hover:not(:disabled) {
  text-decoration: underline;
}

/* ===========================================
   Button Mobile Responsive Sizes
   =========================================== */

/* Tablet (768px) - slightly smaller buttons */
@media (max-width: 768px) {
  [class*='btn-variant-'].h-10 {
    padding: 8px 16px;
    min-height: 36px;
    font-size: 13px;
  }

  [class*='btn-variant-'].h-11 {
    padding: 10px 20px;
    min-height: 40px;
    font-size: 13px;
  }
}

/* Mobile (640px) - compact buttons */
@media (max-width: 640px) {
  [class*='btn-variant-'].h-10 {
    padding: 6px 12px;
    min-height: 32px;
    font-size: 12px;
  }

  [class*='btn-variant-'].h-11 {
    padding: 8px 14px;
    min-height: 36px;
    font-size: 12px;
  }
}

/* Extra small (380px) - most compact */
@media (max-width: 380px) {
  [class*='btn-variant-'].h-10 {
    padding: 5px 10px;
    min-height: 28px;
    font-size: 11px;
  }

  [class*='btn-variant-'].h-11 {
    padding: 6px 12px;
    min-height: 32px;
    font-size: 11px;
  }
}
