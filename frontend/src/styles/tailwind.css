@import "tailwindcss";
@config "../../tailwind.config.js";

/* Minimal reset for Shadcn when preflight is disabled */
@layer base {
  button, input, textarea, select {
    font: inherit;
  }
  *, ::before, ::after {
    box-sizing: border-box;
    border-width: 0;
    border-style: solid;
    border-color: currentColor;
  }
  :root {
    --background: 0 0% 100%;
    --foreground: 0 0% 3.9%;
    --card: 0 0% 100%;
    --card-foreground: 0 0% 3.9%;
    --popover: 0 0% 100%;
    --popover-foreground: 0 0% 3.9%;
    --primary: 0 0% 9%;
    --primary-foreground: 0 0% 98%;
    --secondary: 0 0% 96.1%;
    --secondary-foreground: 0 0% 9%;
    --muted: 0 0% 96.1%;
    --muted-foreground: 0 0% 45.1%;
    --accent: 0 0% 96.1%;
    --accent-foreground: 0 0% 9%;
    --destructive: 0 84.2% 60.2%;
    --destructive-foreground: 0 0% 98%;
    --border: 0 0% 89.8%;
    --input: 0 0% 89.8%;
    --ring: 0 0% 3.9%;
    --chart-1: 12 76% 61%;
    --chart-2: 173 58% 39%;
    --chart-3: 197 37% 24%;
    --chart-4: 43 74% 66%;
    --chart-5: 27 87% 67%;
    --radius: 0.5rem;

    /* Z-index scale - use these instead of arbitrary values */
    --z-base: 1;
    --z-sticky: 50;
    --z-dropdown: 100;
    --z-modal: 1000;
    --z-modal-dropdown: 1100;
    --z-toast: 1200;

    /* Shadow scale - use these instead of arbitrary box-shadow values */
    --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.05);
    --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    --shadow-lg: 0 10px 25px -5px rgba(0, 0, 0, 0.15);
    --shadow-modal: 0 20px 60px rgba(0, 0, 0, 0.3);
    --shadow-focus: 0 0 0 3px rgba(99, 102, 241, 0.1);

    /* Border radius scale - use these instead of arbitrary pixel values */
    --radius-sm: 4px;
    --radius-md: 8px;
    --radius-lg: 12px;
    --radius-full: 9999px;

    /* ===== COLOR TOKENS ===== */

    /* Text colors */
    --color-text-primary: #333333;
    --color-text-secondary: #666666;
    --color-text-tertiary: #9ca3af;
    --color-text-muted: #888888;
    --color-text-inverse: #ffffff;

    /* Background colors */
    --color-bg-primary: #ffffff;
    --color-bg-secondary: #f9fafb;
    --color-bg-tertiary: #f5f5f5;
    --color-bg-hover: #f3f4f6;
    --color-bg-active: #e5e7eb;

    /* Border colors */
    --color-border: #e5e7eb;
    --color-border-light: #f1f5f9;
    --color-border-dark: #d1d5db;
    --color-border-muted: #dddddd;

    /* Brand colors - Primary Blue */
    --color-brand-primary: #4a90e2;
    --color-brand-primary-hover: #3b82f6;
    --color-brand-primary-light: #f0f7ff;

    /* Brand colors - Orange Accent */
    --color-accent: #f97316;
    --color-accent-hover: #ea580c;
    --color-accent-light: #fff7ed;
    --color-accent-dark: #d97706;
    --color-accent-amber: #f59e0b;

    /* Brand colors - Indigo */
    --color-indigo: #6366f1;
    --color-indigo-light: rgba(99, 102, 241, 0.1);

    /* Semantic colors - Success */
    --color-success: #10b981;
    --color-success-light: #d1fae5;
    --color-success-dark: #059669;
    --color-success-muted: #5a8a5a;
    --color-success-border: #c8e6c8;
    --color-success-bg: #f8faf8;
    --color-success-code: #1b5e20;

    /* Semantic colors - Error */
    --color-error: #ef4444;
    --color-error-light: #fee2e2;
    --color-error-dark: #dc2626;

    /* Semantic colors - Warning */
    --color-warning: #f59e0b;
    --color-warning-light: #fef3c7;
    --color-warning-dark: #d97706;

    /* Semantic colors - Info */
    --color-info: #3b82f6;
    --color-info-light: #dbeafe;

    /* Department colors - for badges and UI elements */
    --color-dept-engineering: #3b82f6;
    --color-dept-design: #8b5cf6;
    --color-dept-product: #10b981;
    --color-dept-marketing: #f59e0b;
    --color-dept-legal: #6b7280;
    --color-dept-finance: #14b8a6;
    --color-dept-hr: #ec4899;
    --color-dept-operations: #f97316;

    /* Curator (purple theme) */
    --color-curator-primary: #9c27b0;
    --color-curator-hover: #7b1fa2;
    --color-curator-dark: #6a1b9a;
    --color-curator-light: #f3e5f5;
    --color-curator-lighter: #e1bee7;
    --color-curator-border: #ce93d8;

    /* ===== TAILWIND COLOR PALETTE TOKENS ===== */

    /* Slate scale - for neutral/gray UI elements */
    --color-slate-50: #f8fafc;
    --color-slate-100: #f1f5f9;
    --color-slate-200: #e2e8f0;
    --color-slate-300: #cbd5e1;
    --color-slate-500: #64748b;
    --color-slate-600: #475569;
    --color-slate-700: #334155;
    --color-slate-800: #1e293b;

    /* Gray scale */
    --color-gray-400: #9ca3af;
    --color-gray-500: #6b7280;
    --color-gray-700: #374151;

    /* Blue scale - for SOP type, links, info */
    --color-blue-100: #dbeafe;
    --color-blue-200: #bfdbfe;
    --color-blue-500: #3b82f6;
    --color-blue-600: #2563eb;
    --color-blue-700: #1d4ed8;
    --color-blue-800: #1e40af;

    /* Green scale - for success states */
    --color-green-50: #f0fdf4;
    --color-green-100: #dcfce7;
    --color-green-300: #86efac;
    --color-green-600: #16a34a;

    /* Emerald scale - for save buttons */
    --color-emerald-400: #34d399;
    --color-emerald-500: #10b981;
    --color-emerald-600: #059669;
    --color-emerald-700: #047857;

    /* Amber scale - for framework type */
    --color-amber-100: #fef3c7;
    --color-amber-200: #fde68a;
    --color-amber-700: #b45309;

    /* Purple scale - for policy type, projects */
    --color-purple-100: #f3e8ff;
    --color-purple-200: #e9d5ff;
    --color-purple-600: #7c3aed;

    /* Violet scale - for project hover states */
    --color-violet-100: #ede9fe;
    --color-violet-200: #ddd6fe;
    --color-violet-300: #c4b5fd;
    --color-violet-400: #a78bfa;
    --color-violet-700: #6d28d9;
    --color-violet-900: #4c1d95;

    /* Indigo extended scale */
    --color-indigo-600: #4f46e5;

    /* Knowledge Base (dark theme) */
    --color-kb-bg-primary: #1a1a2e;
    --color-kb-bg-secondary: #1e1e32;
    --color-kb-bg-tertiary: #16162a;
    --color-kb-bg-hover: #252540;
    --color-kb-border: #2d2d44;
    --color-kb-border-light: #3d3d5c;
    --color-kb-text-primary: #ffffff;
    --color-kb-text-secondary: #ccccdd;
    --color-kb-text-muted: #8888aa;
    --color-kb-text-dim: #6666aa;
    --color-kb-text-subtle: #aaaacc;
    --color-kb-accent: #4a4ae8;
    --color-kb-accent-hover: #5a5af8;
    --color-kb-error: #ff6b6b;

    /* KB Category badges */
    --color-kb-cat-technical-bg: #2d4a7c;
    --color-kb-cat-technical-text: #6fa8dc;
    --color-kb-cat-ux-bg: #5c2d7c;
    --color-kb-cat-ux-text: #b47cdc;
    --color-kb-cat-feature-bg: #2d7c4a;
    --color-kb-cat-feature-text: #6fdc8f;
    --color-kb-cat-policy-bg: #7c5c2d;
    --color-kb-cat-policy-text: #dcb46f;
    --color-kb-cat-process-bg: #7c2d5c;
    --color-kb-cat-process-text: #dc6fb4;
    --color-kb-cat-role-bg: #2d7c7c;
    --color-kb-cat-role-text: #6fdcdc;
    --color-kb-cat-framework-bg: #4a2d7c;
    --color-kb-cat-framework-text: #8f6fdc;
    --color-kb-cat-sop-bg: #7c7c2d;
    --color-kb-cat-sop-text: #dcdc6f;

    /* KB Status badges */
    --color-kb-status-superseded-bg: #7c5c2d;
    --color-kb-status-superseded-text: #dcb46f;
    --color-kb-status-archived-bg: #4a4a5c;
    --color-kb-status-archived-text: #9999aa;

    /* Aurora background colors */
    --white: #fff;
    --black: #000;
    --transparent: transparent;
    --blue-300: #93c5fd;
    --blue-400: #60a5fa;
    --indigo-300: #a5b4fc;

    /* ===== DELIBERATION VIEW TOKENS ===== */

    /* Stage-specific colors */
    --stage1-bg-gradient-start: #eff6ff;
    --stage1-bg-gradient-end: #dbeafe;
    --stage1-border: #93c5fd;
    --stage1-text-primary: #1e40af;
    --stage1-shadow-color: rgba(59, 130, 246, 0.15);

    --stage2-bg-gradient-start: #faf5ff;
    --stage2-bg-gradient-end: #f3e8ff;
    --stage2-border: #e9d5ff;
    --stage2-text-primary: #7c3aed;
    --stage2-shadow-color: rgba(139, 92, 246, 0.15);

    --stage3-bg-gradient-start: #ecfdf5;
    --stage3-bg-gradient-end: #d1fae5;
    --stage3-border: #6ee7b7;
    --stage3-text-primary: #065f46;
    --stage3-shadow-color: rgba(16, 185, 129, 0.15);

    /* Avatar states */
    --avatar-waiting-bg: #f9fafb;
    --avatar-waiting-border: #e5e7eb;
    --avatar-thinking-bg: #eff6ff;
    --avatar-thinking-border: #3b82f6;
    --avatar-thinking-ring: rgba(59, 130, 246, 0.2);
    --avatar-complete-bg: #ecfdf5;
    --avatar-complete-border: #10b981;
    --avatar-reviewing-bg: #fffbeb;
    --avatar-reviewing-border: #f59e0b;
    --avatar-reviewing-ring: rgba(245, 158, 11, 0.2);

    /* Thinking stream */
    --thinking-stream-bg: #1e293b;
    --thinking-stream-border: #334155;
    --thinking-stream-text: #94a3b8;
    --thinking-stream-cursor: #3b82f6;

    /* Insight cards */
    --insight-gap-bg: #fef3c7;
    --insight-gap-border: #f59e0b;
    --insight-gap-text: #92400e;
    --insight-gap-button-bg: #fffbeb;
    --insight-gap-button-hover: #fef3c7;

    --insight-consensus-bg: #d1fae5;
    --insight-consensus-border: #10b981;
    --insight-consensus-text: #065f46;

    --insight-tension-bg: #fee2e2;
    --insight-tension-border: #ef4444;
    --insight-tension-text: #991b1b;

    --insight-context-bg: #dbeafe;
    --insight-context-border: #3b82f6;
    --insight-context-text: #1e40af;

    /* Stage progress */
    --stage-progress-bg: #e5e7eb;
    --stage-progress-complete: #10b981;
    --stage-progress-text: #6b7280;

    /* Overlays */
    --overlay-bg: rgba(255, 255, 255, 0.95);
    --overlay-shimmer: rgba(255, 255, 255, 0.4);
  }
  .dark {
    --background: 0 0% 3.9%;
    --foreground: 0 0% 98%;
    --card: 0 0% 3.9%;
    --card-foreground: 0 0% 98%;
    --popover: 0 0% 3.9%;
    --popover-foreground: 0 0% 98%;
    --primary: 0 0% 98%;
    --primary-foreground: 0 0% 9%;
    --secondary: 0 0% 14.9%;
    --secondary-foreground: 0 0% 98%;
    --muted: 0 0% 14.9%;
    --muted-foreground: 0 0% 63.9%;
    --accent: 0 0% 14.9%;
    --accent-foreground: 0 0% 98%;
    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 0 0% 98%;
    --border: 0 0% 14.9%;
    --input: 0 0% 14.9%;
    --ring: 0 0% 83.1%;
    --chart-1: 220 70% 50%;
    --chart-2: 160 60% 45%;
    --chart-3: 30 80% 55%;
    --chart-4: 280 65% 60%;
    --chart-5: 340 75% 55%;

    /* ===== DARK MODE COLOR TOKENS ===== */

    /* Text colors */
    --color-text-primary: #f1f5f9;
    --color-text-secondary: #94a3b8;
    --color-text-tertiary: #64748b;
    --color-text-muted: #475569;
    --color-text-inverse: #0f172a;

    /* Background colors */
    --color-bg-primary: #0f172a;
    --color-bg-secondary: #1e293b;
    --color-bg-tertiary: #334155;
    --color-bg-hover: #334155;
    --color-bg-active: #475569;

    /* Border colors */
    --color-border: #334155;
    --color-border-light: #1e293b;
    --color-border-dark: #475569;
    --color-border-muted: #334155;

    /* Brand colors - slightly brighter for dark mode */
    --color-brand-primary: #60a5fa;
    --color-brand-primary-hover: #3b82f6;
    --color-brand-primary-light: rgba(59, 130, 246, 0.15);

    /* Semantic colors - adjusted for dark */
    --color-success-light: rgba(16, 185, 129, 0.15);
    --color-error-light: rgba(239, 68, 68, 0.15);
    --color-warning-light: rgba(245, 158, 11, 0.15);
    --color-info-light: rgba(59, 130, 246, 0.15);

    /* Slate scale - inverted */
    --color-slate-50: #1e293b;
    --color-slate-100: #334155;
    --color-slate-200: #475569;
    --color-slate-300: #64748b;
    --color-slate-500: #94a3b8;
    --color-slate-600: #cbd5e1;
    --color-slate-700: #e2e8f0;
    --color-slate-800: #f1f5f9;

    /* Stage colors - dark variants */
    --stage1-bg-gradient-start: #1e293b;
    --stage1-bg-gradient-end: #0f172a;
    --stage1-border: #3b82f6;
    --stage1-text-primary: #93c5fd;

    --stage2-bg-gradient-start: #1e293b;
    --stage2-bg-gradient-end: #0f172a;
    --stage2-border: #8b5cf6;
    --stage2-text-primary: #c4b5fd;
    --stage2-shadow-color: rgba(139, 92, 246, 0.25);

    --stage3-bg-gradient-start: #1e293b;
    --stage3-bg-gradient-end: #0f172a;
    --stage3-border: #10b981;
    --stage3-text-primary: #6ee7b7;

    /* Overlays - dark variants */
    --overlay-bg: rgba(15, 23, 42, 0.95);
    --overlay-shimmer: rgba(255, 255, 255, 0.05);

    /* Glass morphism - dark mode */
    --glass-bg: rgba(30, 41, 59, 0.85);
    --glass-bg-focus: rgba(30, 41, 59, 0.95);
    --glass-border: rgba(51, 65, 85, 0.6);
    --glass-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
  }
}

@layer base {
  * {
    border-color: hsl(var(--border));
  }
  body {
    background-color: hsl(var(--background));
    color: hsl(var(--foreground));
  }
}

/* Aurora animation keyframes */
@keyframes aurora {
  from {
    background-position: 50% 50%, 50% 50%;
  }
  to {
    background-position: 350% 50%, 350% 50%;
  }
}

.animate-aurora {
  animation: aurora 60s linear infinite;
}

/* ============================================================================
   MOBILE LANDSCAPE ORIENTATION SUPPORT
   ============================================================================ */

@media (max-width: 900px) and (orientation: landscape) {
  /* Reduce vertical heights in landscape */
  .input-form {
    padding: 10px 16px !important;
    gap: 8px !important;
  }

  .message-input {
    min-height: 40px !important;
    max-height: 120px !important;
  }

  /* Sidebar narrower in landscape */
  .sidebar {
    width: 240px !important;
    max-width: 240px !important;
  }

  /* Messages container - maximize vertical space */
  .messages-container {
    padding: 12px 16px !important;
  }

  .message-group {
    margin-bottom: 16px !important;
  }

  /* Landing hero - horizontal layout in landscape */
  .landing-hero {
    max-width: 90vw !important;
    gap: 16px !important;
  }

  /* Modal optimization - reduce height */
  .app-modal-content,
  .mc-panel {
    max-height: 85vh !important;
  }

  /* Settings sidebar - horizontal in landscape */
  .settings-sidebar {
    flex-direction: row !important;
    overflow-x: auto !important;
    -webkit-overflow-scrolling: touch;
    scrollbar-width: none;
  }

  .settings-sidebar::-webkit-scrollbar {
    display: none;
  }

  /* Reduce padding on modals */
  .mc-header,
  .mc-content {
    padding: 12px 16px !important;
  }

  /* Context bar stays compact */
  .context-bar {
    gap: 6px !important;
  }
}

/* iPhone SE landscape specific (568px wide) */
@media (max-height: 400px) and (orientation: landscape) {
  .message-input {
    min-height: 36px !important;
    max-height: 80px !important;
  }

  .send-button,
  .stop-button {
    padding: 8px 12px !important;
    font-size: 12px !important;
  }

  .input-form {
    padding: 8px 12px !important;
  }

  .mc-panel {
    height: 100vh !important;
    max-height: 100vh !important;
    border-radius: 0 !important;
  }
}

/* ============================================================================
   TOUCH TARGET MINIMUM SIZE UTILITIES
   ============================================================================ */

@media (max-width: 768px) {
  /* Ensure minimum 44x44px touch targets on mobile */
  button:not(.no-touch-target),
  .button:not(.no-touch-target),
  [role="button"]:not(.no-touch-target),
  a.clickable:not(.no-touch-target) {
    min-width: 44px;
    min-height: 44px;
  }

  /* Icon-only buttons need internal padding */
  button.icon-only,
  .button.icon-only,
  .icon-btn {
    padding: 10px !important;
  }

  /* Ensure adequate spacing between touch targets */
  .touch-spacing > * + * {
    margin-left: 8px;
  }
}

/* Utility class to force touch target size */
.touch-target {
  min-width: 44px;
  min-height: 44px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

/* ============================================================================
   SMOOTH SCROLLING & MOBILE SCROLL BEHAVIOR
   ============================================================================ */

html {
  scroll-behavior: smooth;
}

/* iOS-style momentum scrolling */
.messages-container,
.sidebar,
.mc-content,
.settings-main {
  -webkit-overflow-scrolling: touch;
  overscroll-behavior: contain;
}

/* Hide scrollbars on mobile (iOS pattern) */
@media (max-width: 768px) {
  .messages-container::-webkit-scrollbar,
  .sidebar::-webkit-scrollbar,
  .mc-content::-webkit-scrollbar {
    display: none;
  }

  .messages-container,
  .sidebar,
  .mc-content {
    scrollbar-width: none;
    -ms-overflow-style: none;
  }
}

/* Respect reduced motion preference */
@media (prefers-reduced-motion: reduce) {
  *,
  ::before,
  ::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}

/* ============================================================================
   MOBILE TYPOGRAPHY REFINEMENTS
   ============================================================================ */

@media (max-width: 768px) {
  /* Prevent iOS zoom on input focus */
  input[type="text"],
  input[type="email"],
  input[type="password"],
  input[type="search"],
  textarea,
  select {
    font-size: 16px !important;
  }

  /* Enable iOS text size adjustment */
  body {
    -webkit-text-size-adjust: 100%;
    text-size-adjust: 100%;
  }
}

/* ============================================================================
   SMOOTH THEME TRANSITIONS
   ============================================================================ */

/* Transition colors smoothly when theme changes */
*,
*::before,
*::after {
  transition-property: background-color, border-color, color, fill, stroke, box-shadow;
  transition-duration: 0.15s;
  transition-timing-function: ease-out;
}

/* Exclude elements that shouldn't transition */
.no-theme-transition,
.no-theme-transition *,
input,
textarea,
select,
button,
a,
[role="button"] {
  transition-property: none;
}

/* Re-enable specific transitions for interactive elements */
button,
a,
[role="button"] {
  transition: background-color 0.15s ease, border-color 0.15s ease, transform 0.15s ease, box-shadow 0.15s ease;
}

/* ============================================================================
   VISUAL DENSITY OPTIMIZATION (Mobile)
   ============================================================================ */

@media (max-width: 768px) {
  /* Tighter spacing on mobile for more content visibility */
  .gap-tight {
    gap: 8px !important;
  }

  /* Compact padding utility */
  .p-compact {
    padding: 12px !important;
  }

  /* Smaller font for secondary text */
  .text-secondary,
  .text-muted {
    font-size: 13px !important;
  }

  /* Reduce line height for denser content */
  .leading-tight-mobile {
    line-height: 1.4 !important;
  }
}

@media (max-width: 480px) {
  /* Even tighter on small phones */
  .gap-tight {
    gap: 6px !important;
  }

  .p-compact {
    padding: 10px !important;
  }

  .text-secondary,
  .text-muted {
    font-size: 12px !important;
  }
}

/* ============================================================================
   BUTTON MICRO-INTERACTIONS
   ============================================================================ */

/* Subtle scale on hover for premium feel */
button:not(:disabled):hover,
.button:not(:disabled):hover,
[role="button"]:not(:disabled):hover {
  transform: translateY(-1px);
}

button:not(:disabled):active,
.button:not(:disabled):active,
[role="button"]:not(:disabled):active {
  transform: translateY(0) scale(0.98);
}

/* Disable hover transforms on mobile (touch devices) */
@media (hover: none) {
  button:hover,
  .button:hover,
  [role="button"]:hover {
    transform: none;
  }

  button:active,
  .button:active,
  [role="button"]:active {
    transform: scale(0.98);
  }
}
