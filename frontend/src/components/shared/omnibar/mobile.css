/* OmniBar - Mobile Responsive */

/* Extracted from OmniBar.css lines 840-993 */

/* =============================================================================
   MOBILE CONTEXT BUTTON (Perplexity-inspired)
   Single button that opens unified context menu - replaces individual icons
   ============================================================================= */

/* Context button - MUST match .omni-inline-mode-toggle dimensions exactly */
.mobile-context-btn {
  display: flex;
  align-items: center;
  gap: var(--gap-xs);
  padding: var(--space-0-5); /* Match mode toggle outer padding */
  background: var(--color-bg-tertiary);
  border: 1px solid var(--color-border-light);
  border-radius: var(--radius-full);
  color: var(--color-text-secondary);
  font-size: var(--text-xs);
  font-weight: 600;
  cursor: pointer;
  transition: all 0.15s ease;
  flex-shrink: 0;
}

/* Inner content area - matches .inline-mode-indicator padding */
.mobile-context-btn .mobile-context-label {
  padding: var(--space-1) var(--space-2-5);
  white-space: nowrap;
}

/* Icon inside the button */
.mobile-context-btn svg {
  margin-left: var(--space-1-5);
}

.mobile-context-btn:hover:not(:disabled) {
  background: var(--color-bg-hover);
  border-color: var(--color-border-dark);
}

.mobile-context-btn:active:not(:disabled) {
  transform: scale(0.98);
}

.mobile-context-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.mobile-context-btn.has-selection {
  background: var(--color-indigo-50);
  border-color: var(--color-indigo-300);
  color: var(--color-indigo-700);
}

/* Dark mode - base Context button (matches mode toggle styling) */
.dark .mobile-context-btn {
  background: var(--color-bg-secondary);
  border-color: var(--color-border);
  color: var(--color-text-secondary);
}

.dark .mobile-context-btn:hover:not(:disabled) {
  background: var(--color-bg-hover);
  border-color: var(--color-border-dark);
}

.dark .mobile-context-btn.has-selection {
  background: var(--overlay-indigo-15);
  border-color: var(--color-indigo-600);
  color: var(--color-indigo-300);
}

/* Badge for selection count - subtle, not prominent */
.mobile-context-badge {
  display: flex;
  align-items: center;
  justify-content: center;
  min-width: 16px;
  height: 16px;
  padding: 0 4px;
  margin-right: var(--space-1);
  background: var(--color-bg-tertiary);
  color: var(--color-text-secondary);
  font-size: var(--text-2xs);
  font-weight: 600;
  border-radius: var(--radius-full);
}

.dark .mobile-context-badge {
  background: var(--color-bg-hover);
  color: var(--color-text-tertiary);
}

/* =============================================================================
   MOBILE CONTEXT MENU (Accordion sections inside BottomSheet)
   ============================================================================= */

.mobile-context-menu {
  display: flex;
  flex-direction: column;
  gap: var(--gap-xs);
  padding: var(--space-2);
}

.context-section {
  background: var(--color-bg-tertiary);
  border-radius: var(--radius-lg);
  overflow: hidden;
}

.context-section-header {
  display: flex;
  align-items: center;
  gap: var(--gap-sm);
  width: 100%;
  padding: var(--space-3-5) var(--space-4);
  background: transparent;
  border: none;
  color: var(--color-text-primary);
  font-size: var(--text-base);
  font-weight: 500;
  cursor: pointer;
  transition: background 0.15s ease;
  text-align: left;
}

/* Standardize section header icons (Issue #2 fix) */
.context-section-header > svg:first-child {
  width: 18px;
  height: 18px;
}

.context-section-header:hover {
  background: var(--color-bg-hover);
}

.context-section-header:active {
  background: var(--overlay-black-10);
}

.context-section-header.expanded {
  background: var(--color-bg-hover);
  border-bottom: 1px solid var(--color-border-light);
}

.context-section-label {
  flex: 1;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

/* Subtle badge for section selection count */
.context-section-badge {
  display: flex;
  align-items: center;
  justify-content: center;
  min-width: 18px;
  height: 18px;
  padding: 0 5px;
  background: var(--color-bg-hover);
  color: var(--color-text-tertiary);
  font-size: var(--text-2xs);
  font-weight: 600;
  border-radius: var(--radius-full);
}

.dark .context-section-badge {
  background: var(--color-bg-tertiary);
  color: var(--color-text-quaternary);
}

.context-section-chevron {
  color: var(--color-text-tertiary);
  transition: transform 0.2s ease;
  flex-shrink: 0;
}

.context-section-chevron.rotated {
  transform: rotate(90deg);
}

.context-section-content {
  padding: var(--space-2);
  padding-top: 0;
}

/* Override nested list styles inside context sections */
.context-section-content .context-popover-list {
  padding: 0;
  gap: var(--gap-xs);
}

.context-section-content .context-popover-item {
  padding: var(--space-3) var(--space-3-5);
  min-height: 48px;
}

/* =============================================================================
   MOBILE ADJUSTMENTS
   ============================================================================= */

@media (width <= 640px) {
  .omni-bar-wrapper {
    max-width: 100%;
  }

  .omni-bar-top {
    padding: var(--space-2-5) var(--space-3) 6px;
  }

  .omni-bar-landing .omni-bar-top {
    padding: var(--space-3) var(--space-3-5) 8px;
  }

  .omni-bar-bottom {
    padding: var(--space-1-5) var(--space-2-5) 10px;
    gap: var(--gap-xs);

    /* Prevent overflow - ensure right side stays visible */
  }

  .omni-bar-landing .omni-bar-bottom {
    padding: var(--space-2) var(--space-3) 12px;
  }

  /* Left side must shrink to make room for right side actions */
  .omni-bar-left {
    flex: 1 1 0%; /* Can grow and shrink */
    min-width: 0; /* Allow shrinking below content size */
    overflow: visible; /* Let capsule handle its own scroll */
  }

  /* Right side must stay visible - never shrink, but use compact sizing */
  .omni-bar-right {
    flex-shrink: 0;
    gap: 4px;
  }

  /* Compact action buttons on mobile */
  .omni-bar-right .omni-icon-btn {
    width: 36px;
    height: 36px;
    min-width: 36px;
    min-height: 36px;
  }

  .omni-bar-right .omni-bar-submit {
    width: 36px;
    height: 36px;
    min-width: 36px;
  }

  .omni-bar-input {
    font-size: var(--text-base); /* Prevent iOS zoom */
  }

  .omni-mode-toggle {
    width: 100%;
    justify-content: stretch;
  }

  .omni-mode-btn {
    flex: 1;
  }

  /* Capsule is hidden on mobile - using single Context button instead */
  .context-icons-capsule-wrapper {
    display: none;
  }

  /* Attach button - WCAG 44px touch target */
  .omni-icon-btn.attach {
    width: 44px;
    height: 44px;
  }

  /* Reset button - smaller on mobile to save space */
  .omni-reset-all {
    width: 28px;
    height: 28px;
    min-width: 28px;
    flex-shrink: 0;
  }

  .omni-bar-submit {
    width: 44px;
    height: 44px;
  }

  /* Inline mode toggle - very compact on mobile, now on right side */
  .omni-inline-mode-toggle {
    padding: 1px;
    min-height: 28px;
    margin-left: 0;
    flex-shrink: 0;
  }

  .inline-mode-indicator {
    padding: 4px 6px;
    font-size: var(--text-2xs); /* 10px - closest to 9px */
    min-height: 24px;
    display: flex;
    align-items: center;
  }

  /* Context popover on mobile - card-style items like DepartmentCheckboxItem */
  .context-popover-list {
    gap: var(--gap-xs-plus); /* Gap between card items */
    padding: var(--space-2);
  }

  .context-popover-item {
    padding: var(--space-3-5) var(--space-4); /* Match DepartmentCheckboxItem mobile padding */
    font-size: var(--text-base); /* Match DepartmentCheckboxItem mobile font */
    min-height: 56px; /* Match DepartmentCheckboxItem mobile height */
    background: var(--color-bg-tertiary); /* Card background - visible in light mode */
    border-radius: var(--radius-lg); /* Match DepartmentCheckboxItem */
  }

  .context-popover-item:active {
    background: var(--color-bg-hover);
    transform: scale(0.98);
  }

  .context-popover-item.selected {
    background: var(--color-bg-hover);
  }

  /* Larger checkbox/radio on mobile - match DepartmentCheckboxItem.mobile (22px) */
  .context-popover-checkbox,
  .context-popover-radio {
    width: 22px;
    height: 22px;
    border-radius: var(--radius-md);
  }

  .context-popover-checkbox svg {
    width: 14px;
    height: 14px;
  }

  .context-popover-radio svg {
    width: 12px;
    height: 12px;
  }

  /* Larger accordion headers for Playbooks */
  .context-popover-group-header.clickable {
    padding: var(--space-3-5) var(--space-3);
    font-size: var(--text-xs-plus);
    min-height: 48px;
    gap: var(--gap-sm-plus);
  }

  .context-popover-group-header .section-chevron {
    width: 16px;
    height: 16px;
  }

  .context-popover-group-header svg {
    width: 16px;
    height: 16px;
  }

  .context-popover-group-header .section-count {
    font-size: var(--text-xs-plus);
  }

  /* Larger expanded items container */
  .context-popover-group-items {
    margin-left: var(--space-5);
    padding-left: var(--space-3);
    margin-top: var(--space-2);
  }

  /* Items inside expanded sections (Playbooks) */
  .context-popover-group-items .context-popover-item {
    padding: var(--space-3) var(--space-3-5);
    font-size: var(--text-sm-plus);
    min-height: 48px;
  }
}
